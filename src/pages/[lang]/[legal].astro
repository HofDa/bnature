---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { content, type Lang } from '../../data/content';
import { legalContent, type LegalSlug } from '../../data/legal';
import '../../styles/globals.css';

type Params = {
  lang: Lang;
  legal: LegalSlug;
};

export const getStaticPaths = () => {
  const langs: Lang[] = ['de', 'it'];
  const docs: LegalSlug[] = ['impressum', 'privacy', 'cookies'];

  return langs.flatMap((lang) => docs.map((legal) => ({ params: { lang, legal } })));
};

const { lang, legal } = Astro.params as Params;

if (!(lang in legalContent) || !(legal in legalContent[lang])) {
  throw new Error(`Unsupported legal route: ${lang}/${legal}`);
}

const page = legalContent[lang][legal];
const backLabel = lang === 'de' ? 'Zur Startseite' : 'Torna alla home';
const homepageTitle = content[lang].title;
const canonicalPath = `/${lang}/${legal}`;
const alternateDePath = `/de/${legal}`;
const alternateItPath = `/it/${legal}`;
---
<BaseLayout
  lang={lang}
  title={`${page.title} | b*nature`}
  description={page.description}
  canonicalPath={canonicalPath}
  alternateDePath={alternateDePath}
  alternateItPath={alternateItPath}
>
  <main class="font-body text-bark-700">
    <section class="section">
      <div class="container max-w-4xl">
        <a href={`/${lang}`} class="text-sm text-primary-700 hover:underline">{backLabel}</a>
        <h1 class="h1 mt-4 text-4xl md:text-5xl">{page.title}</h1>
        <p class="mt-3 text-sm text-bark-700/70">{page.updated}</p>
        <p class="lead mt-4">{page.description}</p>

        <div class="mt-8 space-y-5">
          {page.sections.map((section) => (
            <article class="card p-6">
              <h2 class="text-xl font-semibold text-bark-700">{section.heading}</h2>
              <div class="mt-3 space-y-2 text-bark-700/90">
                {section.body.map((line) => (
                  <p>{line}</p>
                ))}
              </div>
            </article>
          ))}
        </div>

        <p class="mt-10 text-sm text-bark-700/70">{homepageTitle}</p>
      </div>
    </section>
  </main>
</BaseLayout>
